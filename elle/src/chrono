#ifndef ELLE_CHRONO
# define ELLE_CHRONO

# include_next <chrono>

# include <ostream>
# include <cmath>

namespace std
{
  template <typename T, std::intmax_t Num, std::intmax_t Denom>
  std::ostream&
  operator << (std::ostream& o,
               std::chrono::duration<T, std::ratio<Num, Denom>> const& t)
  {
    auto log = std::ceil(std::log10(t.count()));
    auto significant = int(std::pow(10, std::max(log - 3, 0.)));
    auto pretty = double(t.count() / significant) * significant;
    if (Denom / Num / significant >= 1000000000)
      o << (pretty * Num * 1000000000 / Denom) << "ns";
    else if (Denom / Num / significant >= 1000000)
      o << (pretty * Num * 1000000 / Denom) << "us";
    else if (Denom / Num / significant >= 1000)
      o << (pretty * Num * 1000 / Denom) << "ms";
    else
      o << (pretty * Num / Denom) << "s";
    return o;
  }
}

#endif
