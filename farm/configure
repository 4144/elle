#!/bin/sh

set -ex

mkdir -p "$DIR_BUILD"
DIR_BUILD=$(realpath "$DIR_BUILD")
DIR_SOURCE=$(realpath "$DIR_SOURCE")

mkdir -p "$DIR_BUILD"
cd "$DIR_BUILD"
CXX="$(which g++-4.7.1)"
CXXFLAGS="-std=c++11 -DBOOST_ENABLE_THREADS=1 -D_LARGE_FILE -D_FILE_OFFSET_BITS=64 -Wall -Wextra -Wundef -Wpointer-arith -Wabi -Wcast-align -Wno-empty-body"
cmake "-GUnix Makefiles"                    \
	-DCMAKE_CXX_FLAGS="$CXXFLAGS"           \
	-DCMAKE_CXX_COMPILER="$CXX"             \
	-DINFINIT_PLATFORM=linux64              \
	.                                       \
	"$DIR_SOURCE"
